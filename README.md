Курсовая работа по дисциплине "Проектирование высоконагруженных систем"

*Малютин Илья, осень 2025*

## Содержание
* [**1. Тема, аудитория, функционал**](#1-тема-аудитория-функционал)
* [**2. Расчёт нагрузки**](#2-расчёт-нагрузки)

## 1. Тема, аудитория, функционал

### Тема

Mail.ru Почта - это бесплатный веб-сервис электронной почты, входящий в состав крупного российского интернет-портала Mail.ru (сейчас принадлежит холдингу VK)

### Аудитория

#### Российский и международный рынок [[1](https://vk.company/ru/press/releases/11388)]
* Пользователи:
  * **51 млн. MAU** 
  * **2.5 млн. DAU**
  * **Общее количество зарегистрированных почтовых ящиков: более 1 млрд**

#### Распределение по странам [[4](https://www.alexa.com/siteinfo/mail.ru)]
* *Россия - ```85.6%``` трафика*
* *Белоруссия - ```2.1%``` трафика*
* *Казахстан - ```1.7%``` трафика*
* *Украина - ```1.3%``` трафика*
* *США - ```1.2%``` трафика*
* *Остальные страны - ```8.1%``` трафика*

### Функционал

Ключевой функционал - прием, отправка и хранение электронных писем

Ключевые продуктовые решения:
* Неограниченный объем почтового ящика
* Интеграция с облачным хранилищем для вложений
* Умная сортировка писем (Спам, Социальные сети, Рассылки)

* Регистрация и авторизация
* Отправка писем
  * Текст письма
  * Вложения (файлы, изображения)
  * Черновики
* Получение и чтение писем
* Управление папками (Входящие, Отправленные, Черновики, Спам)
* Поиск по письмам
* Управление контактами

## 2. Расчёт нагрузки

* Допущения:
  * Средний размер письма без вложений: 10 КБ
  * Средний размер письма с вложениями: 2 МБ (20% писем содержат вложения)
  * Среднее количество писем на пользователя в день: 10 (5 входящих, 5 исходящих)
  * Средний размер аватарки пользователя: 50 КБ
  * Размер профиля пользователя (имя, контакты): 2 КБ
  * Пиковая нагрузка в 3 раза больше средней
  * 30% пользователей активны ежедневно (DAU/MAU = 0.3)

### Расчет среднего размера хранилища на одного пользователя

* Профиль пользователя (аватар + данные):
$$\frac{50 + 2}{1024} \approx 0.05 \space МБ$$

* Письма за месяц (30 дней):
$$\text{Средний размер письма} = 0.8 \times 10 + 0.2 \times 2048 \approx 417.6 \space КБ$$
$$\frac{417.6 \times 10 \times 30}{1024} \approx 122.3 \space МБ/месяц$$

* Контакты (50 контактов по 1 КБ каждый):
$$\frac{50}{1024} \approx 0.05 \space МБ$$

### Расчет среднего количества действий пользователя по типам в день

* Авторизация: 1 раз в день
* Отправка писем: 5 писем/день
* Получение писем: 5 писем/день
* Чтение писем: 10 писем/день (просмотр списка + чтение)
* Поиск по письмам: 2 запроса/день
* Управление контактами: 1 операция/день

### Продуктовые метрики

| Метрика                                | Значение                  |
|----------------------------------------|---------------------------|
| Месячная аудитория (MAU)               | 51 млн пользователей     |
| Дневная аудитория (DAU)                | 2.5 млн пользователей      |
| Профиль пользователя                   | ~0.05 МБ                  |
| Письма (ежемесячный прирост)           | ~122.3 МБ                 |
| Контакты                               | ~0.05 МБ                  |
| Авторизация                            | 1/день                    |
| Отправка писем                         | 5/день                    |
| Получение писем                        | 5/день                    |
| Чтение писем                           | 10/день                   |
| Поиск по письмам                       | 2/день                    |
| Управление контактами                  | 1/день                    |

### Расчет размера хранилища данных

* Профили пользователей:
$$\frac{0.05 \times 51 \times 10^6}{1024} \approx 2.49 \space ГБ$$

* Письма за месяц:
$$\frac{122.3 \times 51 \times 10^6}{1024} \approx 6.09 \space ТБ/месяц$$

* Письма за год (с учетом архивации):
$$\frac{6.09 \times 12}{1024} \approx 0.07 \space ПБ/год$$

* Контакты пользователей:
$$\frac{0.05 \times 51 \times 10^6}{1024} \approx 2.49 \space ГБ$$

### Расчет сетевого трафика

* Исходящий трафик (отправка писем):
$$\frac{417.6 \times 5 \times 2.5 \times 10^6}{1024 \times 1024} \approx 0.49 \space ТБ/день$$

* Входящий трафик (получение писем):
$$\frac{417.6 \times 5 \times 2.5 \times 10^6}{1024 \times 1024} \approx 0.49 \space ТБ/день$$

* Общий суточный трафик:
$$0.98 \space ТБ/день$$

* Пиковое потребление (3-часовой пик, равномерно распределенный):
$$\frac{0.98 \times 1024 \times 8}{24 \times 3600} \times 3 \approx 0.28 \space Гбит/с$$

### RPS (Requests Per Second)

| Действие                               | RPS в пике                | RPS (средний)           |
|----------------------------------------|---------------------------|-------------------------|
| Авторизация                            | 29                       | $$\frac{2.5 \times 10^6}{24 \times 3600} \approx 9.67$$ |
| Отправка писем                         | 144.8                      | $$\frac{5 \times 2.5 \times 10^6}{24 \times 3600} \approx 48.25$$ |
| Получение писем                        | 144.8                      | $$\frac{5 \times 2.5 \times 10^6}{24 \times 3600} \approx 48.25$$ |
| Чтение писем                           | 289.2                      | $$\frac{10 \times 2.5 \times 10^6}{24 \times 3600} \approx 96.4$$ |
| Поиск по письмам                       | 57.8                       | $$\frac{2 \times 2.5 \times 10^6}{24 \times 3600} \approx 19.25$$ |
| Управление контактами                  | 29                       | $$\frac{1 \times 2.5 \times 10^6}{24 \times 3600} \approx 9.67$$ |

## Источники
1. [Пресс релиз 2023г]([[1](https://vk.company/ru/press/releases/11388)])
2. [VK Company - Статистика](https://vk.company/ru/company/statistics/)
3. https://hypestat.com/info/e.mail.ru
4. [Alexa - Mail.ru Traffic Analytics](https://www.alexa.com/siteinfo/mail.ru)